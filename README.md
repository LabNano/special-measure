Code imported from https://code.google.com/archive/p/special-measure/
